extends layout

block content
  h1= title
  form(id='CostumeForm', action='resource/costumes', method='POST')
    div.form-group
      label(for='costume_type') Costume type
      input#costume_type(type='text', name='costume_type')
    div.form-group
      label(for='size') Costume size
      input#size(type='text', name='size')
    div.form-group
      label(for='cost') Costume cost
      input#cost(type='number', name='cost')
    input(type='submit')

  script.
    document.forms['CostumeForm'].addEventListener('submit', (event) => {
      event.preventDefault();
      // Show user that form is being submitted (optional)
      
      // Use fetch to send form data
      fetch(event.target.action, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded',  // Ensure correct content type
        },
        body: new URLSearchParams(new FormData(event.target)) // Form data as URLSearchParams
      })
      .then((resp) => {
        if (!resp.ok) {  // Check if the response is not successful (status not 2xx)
          throw new Error(`HTTP error! Status: ${resp.status}`);
        }
        return resp.json();  // Parse JSON if response is OK
      })
      .then((body) => {
        alert("Save succeeded");
        console.log("Response body:", body);
        // Optionally, update the UI or handle the response body as needed
      })
      .catch((error) => {
        console.error("Error:", error);  // Log the error for debugging
        alert("Save failed: " + error.message);
        // Optionally, show an error message on the page
      });
    });
